<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Construction Field Verification</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef } = React;

        // Lucide React Icons as inline SVG components
        const Camera = ({ className = "w-6 h-6" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/>
                <circle cx="12" cy="13" r="3"/>
            </svg>
        );

        const FileText = ({ className = "w-6 h-6" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                <polyline points="14 2 14 8 20 8"/>
                <line x1="16" y1="13" x2="8" y2="13"/>
                <line x1="16" y1="17" x2="8" y2="17"/>
                <polyline points="10 9 9 9 8 9"/>
            </svg>
        );

        const Plus = ({ className = "w-6 h-6" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"/>
                <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
        );

        const Trash2 = ({ className = "w-6 h-6" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="3 6 5 6 21 6"/>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                <line x1="10" y1="11" x2="10" y2="17"/>
                <line x1="14" y1="11" x2="14" y2="17"/>
            </svg>
        );

        const Download = ({ className = "w-6 h-6" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7 10 12 15 17 10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
            </svg>
        );

        const Upload = ({ className = "w-6 h-6" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="17 8 12 3 7 8"/>
                <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
        );

        const CheckCircle = ({ className = "w-6 h-6" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
        );

        const AlertCircle = ({ className = "w-6 h-6" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
        );

        function App() {
            const [project, setProject] = useState({
                name: '',
                payAppDate: new Date().toISOString().split('T')[0],
                periodStart: '',
                periodEnd: '',
                observationDate: new Date().toISOString().split('T')[0]
            });
            const [items, setItems] = useState([]);
            const [photos, setPhotos] = useState({});
            const [notes, setNotes] = useState({});
            const [uploadingPdf, setUploadingPdf] = useState(false);
            const [pdfError, setPdfError] = useState('');
            const [showBulkAdd, setShowBulkAdd] = useState(false);
            const [bulkText, setBulkText] = useState('');
            const pdfInputRef = useRef(null);

            const extractTextFromPDF = async (file) => {
                setUploadingPdf(true);
                setPdfError('');
                
                try {
                    const arrayBuffer = await file.arrayBuffer();
                    const uint8Array = new Uint8Array(arrayBuffer);
                    
                    let binary = '';
                    const len = uint8Array.byteLength;
                    for (let i = 0; i < len; i++) {
                        binary += String.fromCharCode(uint8Array[i]);
                    }
                    const base64 = btoa(binary);

                    const response = await fetch('https://api.anthropic.com/v1/messages', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'anthropic-version': '2023-06-01'
                        },
                        body: JSON.stringify({
                            model: 'claude-sonnet-4-20250514',
                            max_tokens: 4096,
                            messages: [{
                                role: 'user',
                                content: [
                                    {
                                        type: 'document',
                                        source: {
                                            type: 'base64',
                                            media_type: 'application/pdf',
                                            data: base64
                                        }
                                    },
                                    {
                                        type: 'text',
                                        text: `Extract payment application data from this PDF. ONLY include items that require field verification (like MATERIAL, OTHER COSTS, or specific construction work items). EXCLUDE items that are not subject to field verification (like LABOR).

Return a JSON object with this structure:
{
  "projectInfo": {
    "name": "project name",
    "payAppDate": "YYYY-MM-DD",
    "periodStart": "YYYY-MM-DD",
    "periodEnd": "YYYY-MM-DD"
  },
  "lineItems": [
    {
      "description": "item description",
      "needsVerification": true,
      "workCompletedThisPeriod": "dollar amount",
      "valueRequested": "dollar amount"
    }
  ]
}

For each line item:
- Only include items that need field verification
- Extract "This Period" value as workCompletedThisPeriod
- Extract the total completed/requested amount as valueRequested
- Set needsVerification to true for all items you include

Return ONLY the JSON object, no other text.`
                                    }
                                ]
                            }]
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`API error: ${response.status}`);
                    }

                    const data = await response.json();
                    
                    if (data.content && data.content.length > 0) {
                        let textContent = data.content
                            .filter(block => block.type === 'text')
                            .map(block => block.text)
                            .join('\n');

                        textContent = textContent.trim();
                        textContent = textContent.replace(/```json\n?/g, '');
                        textContent = textContent.replace(/```\n?/g, '');
                        textContent = textContent.trim();

                        try {
                            const parsed = JSON.parse(textContent);

                            if (parsed.projectInfo) {
                                setProject(prev => ({
                                    ...prev,
                                    name: parsed.projectInfo.name || prev.name,
                                    payAppDate: parsed.projectInfo.payAppDate || prev.payAppDate,
                                    periodStart: parsed.projectInfo.periodStart || prev.periodStart,
                                    periodEnd: parsed.projectInfo.periodEnd || prev.periodEnd
                                }));
                            }

                            if (parsed.lineItems && Array.isArray(parsed.lineItems)) {
                                const newItems = parsed.lineItems
                                    .filter(item => item.needsVerification !== false)
                                    .map((item, idx) => ({
                                        id: Date.now() + idx,
                                        description: item.description || '',
                                        workCompletedThisPeriod: String(item.workCompletedThisPeriod || ''),
                                        valueRequested: String(item.valueRequested || ''),
                                        needsVerification: true,
                                        completed: false
                                    }));
                                
                                setItems(newItems);
                                setPdfError('');
                            } else {
                                throw new Error('No line items found in response');
                            }

                        } catch (parseError) {
                            console.error('JSON Parse Error:', parseError);
                            throw new Error('Could not parse the extracted data. The PDF may have an unusual format.');
                        }

                    } else {
                        throw new Error('No content returned from API');
                    }

                    setUploadingPdf(false);

                } catch (error) {
                    console.error('Extraction error:', error);
                    setPdfError(error.message || 'Failed to extract data from PDF');
                    setUploadingPdf(false);
                }
            };

            const handlePdfUpload = (e) => {
                const file = e.target.files[0];
                if (file && file.type === 'application/pdf') {
                    extractTextFromPDF(file);
                } else {
                    setPdfError('Please upload a valid PDF file');
                }
            };

            const addItem = () => {
                const newItem = {
                    id: Date.now(),
                    description: '',
                    workCompletedThisPeriod: '',
                    valueRequested: '',
                    needsVerification: true,
                    completed: false
                };
                setItems([...items, newItem]);
            };

            const parseBulkText = () => {
                const lines = bulkText.split('\n').filter(line => line.trim());
                const newItems = [];
                
                lines.forEach(line => {
                    const parts = line.split('|').map(p => p.trim());
                    
                    if (parts.length >= 1) {
                        newItems.push({
                            id: Date.now() + Math.random(),
                            description: parts[0] || '',
                            workCompletedThisPeriod: parts[1] || '',
                            valueRequested: parts[2] || '',
                            needsVerification: true,
                            completed: false
                        });
                    }
                });
                
                if (newItems.length > 0) {
                    setItems([...items, ...newItems]);
                    setBulkText('');
                    setShowBulkAdd(false);
                }
            };

            const updateItem = (id, field, value) => {
                setItems(items.map(item => 
                    item.id === id ? { ...item, [field]: value } : item
                ));
            };

            const deleteItem = (id) => {
                setItems(items.filter(item => item.id !== id));
                const newPhotos = { ...photos };
                const newNotes = { ...notes };
                delete newPhotos[id];
                delete newNotes[id];
                setPhotos(newPhotos);
                setNotes(newNotes);
            };

            const handlePhotoCapture = (e, itemId) => {
                const files = Array.from(e.target.files);
                files.forEach(file => {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        setPhotos(prev => ({
                            ...prev,
                            [itemId]: [...(prev[itemId] || []), {
                                url: event.target.result,
                                name: file.name,
                                date: new Date().toLocaleString()
                            }]
                        }));
                    };
                    reader.readAsDataURL(file);
                });
            };

            const deletePhoto = (itemId, photoIndex) => {
                setPhotos(prev => ({
                    ...prev,
                    [itemId]: prev[itemId].filter((_, idx) => idx !== photoIndex)
                }));
            };

            const generateReport = () => {
                const reportContent = `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <style>
                            body { font-family: Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; }
                            h1 { color: #2563eb; border-bottom: 3px solid #2563eb; padding-bottom: 10px; }
                            .project-info { background: #f3f4f6; padding: 15px; margin: 20px 0; border-radius: 8px; }
                            .item { margin: 30px 0; padding: 20px; border: 1px solid #e5e7eb; border-radius: 8px; page-break-inside: avoid; }
                            .item-header { background: #eff6ff; padding: 10px; margin: -20px -20px 15px -20px; border-radius: 8px 8px 0 0; }
                            .completed { background: #d1fae5; }
                            .item-details { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin: 10px 0; }
                            .detail-item { padding: 8px; background: #f9fafb; border-radius: 4px; }
                            .detail-label { font-weight: bold; font-size: 12px; color: #6b7280; text-transform: uppercase; }
                            .detail-value { font-size: 16px; color: #1f2937; margin-top: 2px; }
                            .photos { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin: 15px 0; }
                            .photos img { width: 100%; border-radius: 4px; border: 1px solid #e5e7eb; }
                            .photo-caption { font-size: 12px; color: #6b7280; margin-top: 5px; }
                            .notes { background: #fef3c7; padding: 10px; border-radius: 4px; margin: 10px 0; white-space: pre-wrap; }
                            @media print { .item { page-break-inside: avoid; } }
                        </style>
                    </head>
                    <body>
                        <h1>Field Verification Report</h1>
                        <div class="project-info">
                            <p><strong>Project Name:</strong> ${project.name || 'N/A'}</p>
                            <p><strong>Pay Application Date:</strong> ${project.payAppDate}</p>
                            <p><strong>Pay App Period:</strong> ${project.periodStart || 'N/A'} to ${project.periodEnd || 'N/A'}</p>
                            <p><strong>Observation Date:</strong> ${project.observationDate}</p>
                            <p><strong>Report Generated:</strong> ${new Date().toLocaleString()}</p>
                        </div>
                        
                        <p><em>This report includes only items subject to field verification.</em></p>
                        
                        ${items.map(item => `
                            <div class="item">
                                <div class="item-header ${item.completed ? 'completed' : ''}">
                                    <h3>${item.description || 'Untitled Item'}</h3>
                                    <p><strong>Status:</strong> ${item.completed ? '✓ Verified & Completed' : '○ Pending Verification'}</p>
                                </div>
                                
                                <div class="item-details">
                                    <div class="detail-item">
                                        <div class="detail-label">Work Completed This Period</div>
                                        <div class="detail-value">$${item.workCompletedThisPeriod || '0.00'}</div>
                                    </div>
                                    <div class="detail-item">
                                        <div class="detail-label">Value Requested</div>
                                        <div class="detail-value">$${item.valueRequested || '0.00'}</div>
                                    </div>
                                    <div class="detail-item">
                                        <div class="detail-label">Photos Captured</div>
                                        <div class="detail-value">${photos[item.id] ? photos[item.id].length : 0}</div>
                                    </div>
                                </div>
                                
                                ${notes[item.id] ? `
                                    <div class="notes">
                                        <strong>Observation Notes:</strong><br/>
                                        ${notes[item.id]}
                                    </div>
                                ` : ''}
                                
                                ${photos[item.id] && photos[item.id].length > 0 ? `
                                    <div class="photos">
                                        ${photos[item.id].map(photo => `
                                            <div>
                                                <img src="${photo.url}" alt="Verification photo"/>
                                                <div class="photo-caption">${photo.date}</div>
                                            </div>
                                        `).join('')}
                                    </div>
                                ` : '<p><em>No verification photos captured</em></p>'}
                            </div>
                        `).join('')}
                    </body>
                    </html>
                `;

                const blob = new Blob([reportContent], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `Field_Verification_${project.name.replace(/\s+/g, '_')}_${project.payAppDate}.html`;
                a.click();
                URL.revokeObjectURL(url);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
                    <div className="max-w-4xl mx-auto">
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                            <div className="flex items-center gap-3 mb-6">
                                <FileText className="w-8 h-8 text-blue-600" />
                                <h1 className="text-3xl font-bold text-gray-800">Field Verification</h1>
                            </div>

                            <div className="space-y-4 mb-6">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-1">Project Name</label>
                                    <input
                                        type="text"
                                        placeholder="Enter project name"
                                        value={project.name}
                                        onChange={(e) => setProject({...project, name: e.target.value})}
                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                    />
                                </div>
                                
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Pay App Date</label>
                                        <input
                                            type="date"
                                            value={project.payAppDate}
                                            onChange={(e) => setProject({...project, payAppDate: e.target.value})}
                                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Observation Date</label>
                                        <input
                                            type="date"
                                            value={project.observationDate}
                                            onChange={(e) => setProject({...project, observationDate: e.target.value})}
                                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                        />
                                    </div>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-1">Pay App Period</label>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <input
                                                type="date"
                                                placeholder="Period Start"
                                                value={project.periodStart}
                                                onChange={(e) => setProject({...project, periodStart: e.target.value})}
                                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                        </div>
                                        <div>
                                            <input
                                                type="date"
                                                placeholder="Period End"
                                                value={project.periodEnd}
                                                onChange={(e) => setProject({...project, periodEnd: e.target.value})}
                                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div className="border-t pt-6 mb-6">
                                <div className="flex flex-wrap gap-3">
                                    <input
                                        ref={pdfInputRef}
                                        type="file"
                                        accept="application/pdf"
                                        onChange={handlePdfUpload}
                                        className="hidden"
                                    />
                                    <button
                                        onClick={() => pdfInputRef.current?.click()}
                                        disabled={uploadingPdf}
                                        className="flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50"
                                    >
                                        <Upload className="w-5 h-5" />
                                        {uploadingPdf ? 'Extracting...' : 'Upload Pay App PDF'}
                                    </button>
                                    
                                    <button
                                        onClick={() => setShowBulkAdd(!showBulkAdd)}
                                        className="flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"
                                    >
                                        <Plus className="w-5 h-5" />
                                        Quick Add Items
                                    </button>
                                    
                                    <button
                                        onClick={addItem}
                                        className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                                    >
                                        <Plus className="w-5 h-5" />
                                        Add Single Item
                                    </button>
                                    
                                    <button
                                        onClick={generateReport}
                                        disabled={items.length === 0}
                                        className="flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50"
                                    >
                                        <Download className="w-5 h-5" />
                                        Generate Report
                                    </button>
                                </div>

                                {pdfError && (
                                    <div className="mt-4 p-3 bg-red-50 border border-red-200 rounded-lg">
                                        <div className="flex items-start gap-2">
                                            <AlertCircle className="w-5 h-5 text-red-600 flex-shrink-0 mt-0.5" />
                                            <div className="text-sm text-red-800">{pdfError}</div>
                                        </div>
                                    </div>
                                )}

                                {showBulkAdd && (
                                    <div className="mt-4 p-4 bg-blue-50 rounded-lg">
                                        <h3 className="font-semibold mb-2">Quick Add Items</h3>
                                        <p className="text-sm text-gray-600 mb-3">
                                            Enter items (one per line). Format: Description | Work This Period | Value Requested
                                        </p>
                                        <textarea
                                            value={bulkText}
                                            onChange={(e) => setBulkText(e.target.value)}
                                            placeholder="Example:
Material Installation | 5000 | 15000
Equipment Setup | 3000 | 8000"
                                            className="w-full h-32 px-3 py-2 border border-gray-300 rounded-lg"
                                        />
                                        <div className="flex gap-2 mt-3">
                                            <button
                                                onClick={parseBulkText}
                                                className="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"
                                            >
                                                Add Items
                                            </button>
                                            <button
                                                onClick={() => {
                                                    setShowBulkAdd(false);
                                                    setBulkText('');
                                                }}
                                                className="px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400"
                                            >
                                                Cancel
                                            </button>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>

                        <div className="space-y-4">
                            {items.length === 0 ? (
                                <div className="bg-white rounded-lg shadow p-8 text-center text-gray-500">
                                    <FileText className="w-16 h-16 mx-auto mb-4 opacity-50" />
                                    <p>No verification items yet. Add items manually or upload a pay application PDF.</p>
                                    <p className="text-sm mt-2">Only items requiring field verification will be included.</p>
                                </div>
                            ) : (
                                items.map((item) => (
                                    <div key={item.id} className="bg-white rounded-lg shadow-lg p-6">
                                        <div className="flex items-start gap-4 mb-4">
                                            <div className="flex-1">
                                                <label className="block text-xs font-medium text-gray-600 mb-1">Item Description</label>
                                                <input
                                                    type="text"
                                                    placeholder="Enter item description"
                                                    value={item.description}
                                                    onChange={(e) => updateItem(item.id, 'description', e.target.value)}
                                                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg font-semibold"
                                                />
                                                
                                                <div className="grid grid-cols-2 gap-4 mt-3">
                                                    <div>
                                                        <label className="block text-xs font-medium text-gray-600 mb-1">Work Completed This Period</label>
                                                        <input
                                                            type="text"
                                                            placeholder="$0.00"
                                                            value={item.workCompletedThisPeriod}
                                                            onChange={(e) => updateItem(item.id, 'workCompletedThisPeriod', e.target.value)}
                                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                                        />
                                                    </div>
                                                    <div>
                                                        <label className="block text-xs font-medium text-gray-600 mb-1">Value Requested</label>
                                                        <input
                                                            type="text"
                                                            placeholder="$0.00"
                                                            value={item.valueRequested}
                                                            onChange={(e) => updateItem(item.id, 'valueRequested', e.target.value)}
                                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                                        />
                                                    </div>
                                                </div>
                                            </div>
                                            <button
                                                onClick={() => deleteItem(item.id)}
                                                className="ml-4 p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors"
                                            >
                                                <Trash2 className="w-5 h-5" />
                                            </button>
                                        </div>

                                        <div className="flex items-center gap-2 mb-4 p-3 bg-gray-50 rounded-lg">
                                            <input
                                                type="checkbox"
                                                id={`complete-${item.id}`}
                                                checked={item.completed}
                                                onChange={(e) => updateItem(item.id, 'completed', e.target.checked)}
                                                className="w-5 h-5 text-green-600 rounded focus:ring-2 focus:ring-green-500"
                                            />
                                            <label htmlFor={`complete-${item.id}`} className="flex items-center gap-2 cursor-pointer">
                                                <CheckCircle className={`w-5 h-5 ${item.completed ? 'text-green-600' : 'text-gray-400'}`} />
                                                <span className="text-gray-700 font-medium">Work Verified & Complete</span>
                                            </label>
                                        </div>

                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                                    <Camera className="w-4 h-4 inline mr-2" />
                                                    Verification Photos
                                                </label>
                                                <div className="flex gap-2 mb-3">
                                                    <label className="flex-1 cursor-pointer">
                                                        <input
                                                            type="file"
                                                            accept="image/*"
                                                            multiple
                                                            capture="environment"
                                                            onChange={(e) => handlePhotoCapture(e, item.id)}
                                                            className="hidden"
                                                        />
                                                        <div className="flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-semibold">
                                                            <Camera className="w-4 h-4" />
                                                            Take Photo
                                                        </div>
                                                    </label>
                                                    <label className="flex-1 cursor-pointer">
                                                        <input
                                                            type="file"
                                                            accept="image/*"
                                                            multiple
                                                            onChange={(e) => handlePhotoCapture(e, item.id)}
                                                            className="hidden"
                                                        />
                                                        <div className="flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-semibold">
                                                            <Upload className="w-4 h-4" />
                                                            Upload
                                                        </div>
                                                    </label>
                                                </div>
                                                {photos[item.id] && photos[item.id].length > 0 && (
                                                    <div className="grid grid-cols-2 gap-2">
                                                        {photos[item.id].map((photo, idx) => (
                                                            <div key={idx} className="relative group">
                                                                <img 
                                                                    src={photo.url} 
                                                                    alt={`Photo ${idx + 1}`}
                                                                    className="w-full h-32 object-cover rounded-lg border border-gray-300"
                                                                />
                                                                <button
                                                                    onClick={() => deletePhoto(item.id, idx)}
                                                                    className="absolute top-1 right-1 p-1 bg-red-600 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity"
                                                                >
                                                                    <Trash2 className="w-4 h-4" />
                                                                </button>
                                                                <div className="text-xs text-gray-500 mt-1">{photo.date}</div>
                                                            </div>
                                                        ))}
                                                    </div>
                                                )}
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                                    Observation Notes
                                                </label>
                                                <textarea
                                                    value={notes[item.id] || ''}
                                                    onChange={(e) => setNotes({...notes, [item.id]: e.target.value})}
                                                    placeholder="Add field observations, issues, or notes..."
                                                    className="w-full h-32 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                                                />
                                            </div>
                                        </div>
                                    </div>
                                ))
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
